{"version":3,"file":"ng-zorro-antd-avatar.umd.js","sources":["ng://ng-zorro-antd/avatar/nz-avatar.component.ts","ng://ng-zorro-antd/avatar/nz-avatar.module.ts"],"sourcesContent":["/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Platform } from '@angular/cdk/platform';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  Input,\n  OnChanges,\n  Renderer2,\n  SimpleChanges,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport { NzSizeLDSType, NzSizeMap, NzUpdateHostClassService } from 'ng-zorro-antd/core';\n\nexport type NzAvatarShape = 'square' | 'circle';\nexport type NzAvatarSize = NzSizeLDSType | number;\n\nexport interface NzAvatarSizeMap {\n  [size: string]: string;\n}\n\n@Component({\n  selector: 'nz-avatar',\n  exportAs: 'nzAvatar',\n  templateUrl: './nz-avatar.component.html',\n  providers: [NzUpdateHostClassService],\n  preserveWhitespaces: false,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class NzAvatarComponent implements OnChanges {\n  @Input() nzShape: NzAvatarShape = 'circle';\n  @Input() nzSize: NzAvatarSize = 'default';\n  @Input() nzText: string;\n  @Input() nzSrc: string;\n  @Input() nzSrcSet: string;\n  @Input() nzAlt: string;\n  @Input() nzIcon: string;\n\n  oldAPIIcon = true; // Make the user defined icon compatible to old API. Should be removed in 2.0.\n  hasText: boolean = false;\n  hasSrc: boolean = true;\n  hasIcon: boolean = false;\n  textStyles: {};\n\n  @ViewChild('textEl', { static: false }) textEl: ElementRef;\n\n  private el: HTMLElement = this.elementRef.nativeElement;\n  private prefixCls = 'ant-avatar';\n  private sizeMap: NzSizeMap = { large: 'lg', small: 'sm' };\n\n  constructor(\n    private elementRef: ElementRef,\n    private cd: ChangeDetectorRef,\n    private updateHostClassService: NzUpdateHostClassService,\n    private renderer: Renderer2,\n    private platform: Platform\n  ) {}\n\n  setClass(): this {\n    const classMap = {\n      [this.prefixCls]: true,\n      [`${this.prefixCls}-${this.sizeMap[this.nzSize]}`]: this.sizeMap[this.nzSize],\n      [`${this.prefixCls}-${this.nzShape}`]: this.nzShape,\n      [`${this.prefixCls}-icon`]: this.nzIcon,\n      [`${this.prefixCls}-image`]: this.hasSrc // downgrade after image error\n    };\n    this.updateHostClassService.updateHostClass(this.el, classMap);\n    this.cd.detectChanges();\n    return this;\n  }\n\n  imgError(): void {\n    this.hasSrc = false;\n    this.hasIcon = false;\n    this.hasText = false;\n    if (this.nzIcon) {\n      this.hasIcon = true;\n    } else if (this.nzText) {\n      this.hasText = true;\n    }\n    this.setClass().notifyCalc();\n    this.setSizeStyle();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.hasOwnProperty('nzIcon') && changes.nzIcon.currentValue) {\n      this.oldAPIIcon = changes.nzIcon.currentValue.indexOf('anticon') > -1;\n    }\n    this.hasText = !this.nzSrc && !!this.nzText;\n    this.hasIcon = !this.nzSrc && !!this.nzIcon;\n    this.hasSrc = !!this.nzSrc;\n\n    this.setClass().notifyCalc();\n    this.setSizeStyle();\n  }\n\n  private calcStringSize(): void {\n    if (!this.hasText) {\n      return;\n    }\n\n    const childrenWidth = this.textEl.nativeElement.offsetWidth;\n    const avatarWidth = this.el.getBoundingClientRect().width;\n    const scale = avatarWidth - 8 < childrenWidth ? (avatarWidth - 8) / childrenWidth : 1;\n    this.textStyles = {\n      transform: `scale(${scale}) translateX(-50%)`\n    };\n    if (typeof this.nzSize === 'number') {\n      Object.assign(this.textStyles, {\n        lineHeight: `${this.nzSize}px`\n      });\n    }\n    this.cd.detectChanges();\n  }\n\n  private notifyCalc(): this {\n    // If use ngAfterViewChecked, always demands more computations, so......\n    if (this.platform.isBrowser) {\n      setTimeout(() => {\n        this.calcStringSize();\n      });\n    }\n    return this;\n  }\n\n  private setSizeStyle(): void {\n    const size = typeof this.nzSize === 'string' ? this.nzSize : `${this.nzSize}px`;\n    this.renderer.setStyle(this.el, 'width', size);\n    this.renderer.setStyle(this.el, 'height', size);\n    this.renderer.setStyle(this.el, 'line-height', size);\n    if (this.hasIcon) {\n      this.renderer.setStyle(this.el, 'font-size', `calc(${size} / 2)`);\n    }\n  }\n}\n","/**\n * @license\n * Copyright Alibaba.com All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NzIconModule } from 'ng-zorro-antd/icon';\n\nimport { NzAvatarComponent } from './nz-avatar.component';\n\n@NgModule({\n  declarations: [NzAvatarComponent],\n  exports: [NzAvatarComponent],\n  imports: [CommonModule, NzIconModule]\n})\nexport class NzAvatarModule {}\n"],"names":["Component","NzUpdateHostClassService","ChangeDetectionStrategy","ViewEncapsulation","ElementRef","ChangeDetectorRef","Renderer2","Platform","Input","ViewChild","NgModule","CommonModule","NzIconModule"],"mappings":"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"}